<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Pathways: The Journey of Life</title>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f9f9f9;
        padding: 20px;
    }
    #game-output {
        white-space: pre-wrap;
        background: #fff;
        border: 1px solid #ccc;
        padding: 10px;
        width: 80%;
        height: 500px;
        overflow: auto;
        font-size: 14px;
    }
    #start-btn {
        margin: 10px 0;
        padding: 10px 20px;
        font-size: 16px;
    }
</style>
</head>
<body>
<h1>Pathways: The Journey of Life</h1>
<p>Click "Start Game" to begin. Input will be collected via prompt dialogs. Output will appear in the box below.</p>
<button id="start-btn">Start Game</button>
<pre id="game-output"></pre>
<script>
let pyodideReady = false;
let pyodide;

async function loadPy() {
    pyodide = await loadPyodide();
    pyodideReady = true;
}

loadPy();

document.getElementById("start-btn").addEventListener("click", async () => {
    if (!pyodideReady) {
        alert("Please wait for Pyodide to load.");
        return;
    }
    await pyodide.runPythonAsync(`
import random
import sys
from js import document, prompt

output_element = document.getElementById("game-output")

def print(*args, **kwargs):
    text = " ".join(str(a) for a in args)
    output_element.innerHTML += text + "\\n"
    output_element.scrollTop = output_element.scrollHeight

def input(prompt_text=""):
    user_input = prompt(prompt_text)
    if user_input is None:
        user_input = ""
    return user_input.strip()

class Player:
    def __init__(self, name):
        self.name = name
        self.age = 15
        self.months = 0
        self.health = 100
        self.happiness = 50
        self.math_skills = 10
        self.social_skills = 10
        self.verbal_skills = 10
        self.other_skills = 10
        self.wealth = 0
        self.karma = 0
        self.relationship = 0
        self.turns = 0
        self.relationships = {}
        self.items = []
        self.last_exercise_turn = -6
        self.path = "student"

    def age_up(self):
        self.age += self.months // 12
        self.months = self.months % 12
        if self.months == 0 and self.turns != 0 and self.turns % 12 == 0:
            print(f"\\nHappy Birthday! You are now {self.age} years old.")

    def display_stats(self):
        print(f"\\n--- {self.name}'s Stats ---")
        print(f"Age: {self.age} years {self.months} months")
        print(f"Health: {self.health}")
        print(f"Happiness: {self.happiness}")
        print(f"Math Skills: {self.math_skills}")
        print(f"Social Skills: {self.social_skills}")
        print(f"Verbal Skills: {self.verbal_skills}")
        print(f"Other Skills: {self.other_skills}")
        print(f"Wealth: {self.wealth} {'(In Debt!)' if self.wealth < 0 else ''}")
        print(f"Karma: {self.karma}")
        if self.age >= 18:
            print(f"Relationship: {self.relationship}")

    def update_stats(self,
                     health=0,
                     happiness=0,
                     math_skills=0,
                     social_skills=0,
                     verbal_skills=0,
                     other_skills=0,
                     wealth=0,
                     karma=0,
                     relationship=0):

        def diminished_gain(current, increment):
            if current >= 80:
                increment = max(1, increment // 2)
            return increment

        math_skills = diminished_gain(self.math_skills, math_skills)
        social_skills = diminished_gain(self.social_skills, social_skills)
        verbal_skills = diminished_gain(self.verbal_skills, verbal_skills)
        other_skills = diminished_gain(self.other_skills, other_skills)

        self.health = min(100, max(0, self.health + health))
        self.happiness = min(100, max(0, self.happiness + happiness))
        self.math_skills = min(100, max(0, self.math_skills + math_skills))
        self.social_skills = min(100, max(0, self.social_skills + social_skills))
        self.verbal_skills = min(100, max(0, self.verbal_skills + verbal_skills))
        self.other_skills = min(100, max(0, self.other_skills + other_skills))
        self.wealth = self.wealth + wealth
        self.karma = min(100, max(-100, self.karma + karma))
        self.relationship = min(100, max(0, self.relationship + relationship))

    def is_game_over(self):
        if self.health <= 0:
            print("\\nGame Over: You have passed away due to poor health.")
            return True
        if self.age >= 80:
            print("\\nCongratulations! You have reached the age of 80. Here's your life summary:")
            return True
        return False

    def add_item(self, item):
        self.items.append(item)
        print(f"You bought a {item['name']}. {item['description']}")

class PathwaysGame:

    def get_valid_input(self, prompt_text, valid_options):
        choice = input(prompt_text)
        while choice not in valid_options:
            print("Invalid choice. Please select a valid option.")
            choice = input(prompt_text)
        return choice

    def __init__(self):
        print("Welcome to Pathways: The Journey of Life!")
        name = input("Enter your character's name: ")
        self.player = Player(name)
        self.run_game()

    def run_game(self):
        while not self.player.is_game_over():
            self.player.display_stats()
            self.player.age_up()

            if self.player.turns != 0 and self.player.turns % 37 == 0:
                self.major_decision()

            if self.player.turns != 0 and self.player.turns % random.randint(14, 24) == 0:
                self.random_scenario()

            if self.player.karma == 100 and self.player.wealth > 1000 and self.player.relationship == 0:
                self.date_option()

            self.show_menu()

            if random.randint(1, 10) == 1 and self.player.turns > 0:
                self.random_event()

    def major_decision(self):
        print("\\nYou have reached a major milestone. Choose a new direction for your life:")
        print("1. 
